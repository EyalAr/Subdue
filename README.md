Code for http://eyalarubas.com/javascript-generators-and-callbacks.html